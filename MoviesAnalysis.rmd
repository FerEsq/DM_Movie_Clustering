---
title: "Movies Analysis - Clusters"
author: "Francisco Castillo, Fernanda Esquivel y Andrés Montoya"
date: "29/01/2024"
output:
  html_document:
    df_print: paged
---
```{r}
#install.packages("factoextra")
#install.packages("fpc")
#install.packages("clustertend")
```
```{r}
library(factoextra)
library(fpc)
library(clustertend)
```
# Movies Analysis

## Preprocesamiento de datos
```{r}
movies <- read.csv("data/movies.csv")
useful <- c("popularity", "budget", "revenue", "genresAmount", 
                      "runtime", "productionCountriesAmount", "voteCount", 
                      "voteAvg", "actorsAmount", "castWomenAmount", "castMenAmount")
# Parse Cast Women Amount and Cast Men Amount to numeric
movies$castWomenAmount <- as.numeric(movies$castWomenAmount)
movies$castMenAmount <- as.numeric(movies$castMenAmount)
movies_new <- subset(movies, select = useful)
movies_new <- na.omit(movies_new)
summary(movies_new)
```
### Variables no utiles
- Id: Es el identificador unico y no proporciona información relevante
- original_title y title: Representan el nombre de la pelicula, por lo que no aportan información relevante a menos que se realice un análisis especifico de los nombres de las peliculas
- originalLanguage: Representa el idioma original de la pelicula, no aporta información relevante
- homePage y video: No aporta información relevante para la agrupación de las peliculas
- productionCoAmount, productionCompany y productionCompanyCountry: A pesar de que es importante para el analisis especifico de las peliculas, no aporta información relevante para la agrupación
- actors y actorsCharacter: A pesar de que es importante para el analisis especifico de las peliculas, no aporta información relevante para la agrupación
- actorsPopularity: TODO
- releaseDate: TODO
- director: TODO
- genres: TODO
- productionCountry: TODO



## VAT
```{r}
# Seed for the random sample
set.seed(1313)
# Sample of 1500 rows
sample <- movies_new[sample(1:nrow(movies_new), 1500),]
# Distribution of the sample
distribution <- get_dist(sample)

# Visualize the distribution as a heatmap
fviz_dist(distribution, gradient = list(low= "#ffffff", mid = "white", high ="#000000"))
```

Al realizar el análisis de la distribución de las variables por medio de un heatmap, se puede observar que no se forman clusters claros, por lo que se procederá a realizar un análisis de clusters para determinar la cantidad de clusters que se pueden formar.

## Elbow Method
```{r}
set.seed(1313)
sample <- movies_new[sample(1:nrow(movies_new), 1500),]
fviz_nbclust(sample, kmeans, method = "wss") + geom_vline(xintercept = 3, linetype = 2)
```

Al realizar el análisis del método del codo, se puede observar que el codo se encuentra entre 3 y 4 clusters. Debido a la poca diferencia entre 3 y 4 clusters, se procederá a realizar un análisis de clusters con 3 clusters priorizando así la simplicidad del modelo y el tiempo de ejecución.
